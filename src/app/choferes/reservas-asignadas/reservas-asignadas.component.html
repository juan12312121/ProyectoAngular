<div class="flex bg-[#F0F4FF] min-h-screen">
    <!-- Sidebar -->
    <app-sidebar-chofer></app-sidebar-chofer>
    
    <!-- Main Content -->
    <div class="flex-1 p-6">
      <h1 class="text-3xl font-bold mb-6 text-[#161a2d]">Reservas Asignadas</h1>
      
      <!-- Mostrar mensaje de error si ocurre -->
      <div *ngIf="errorMessage" class="text-red-600 mb-4">
        {{ errorMessage }}
      </div>
      
      <!-- Tabla de Reservas Pendientes -->
      <div class="overflow-x-auto bg-white p-6 rounded-lg shadow-md mb-6">
        <h2 class="text-2xl font-semibold mb-4 text-[#161a2d]">Reservas Pendientes</h2>
        <table class="min-w-full table-auto border-collapse">
          <thead>
            <tr class="bg-[#4f52ba] text-white">
              <th class="text-left px-6 py-4 font-semibold text-sm">ID Reserva</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Nombre Cliente</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Fecha Reserva</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Estado</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Entrega</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let reserva of pendingReservations" class="border-b hover:bg-[#f0f4ff] transition duration-200">
              <td class="px-6 py-4 text-sm text-[#161a2d]">{{ reserva.id_reserva }}</td>
              <td class="px-6 py-4 text-sm text-[#161a2d]">{{ reserva.usuario }}</td>
              <td class="px-6 py-4 text-sm text-[#161a2d]">{{ reserva.fecha_inicio | date: 'yyyy-MM-dd' }}</td>
              <td class="px-6 py-4 text-sm">
                <span *ngIf="reserva.estado_reserva === 'Confirmada'" class="bg-blue-300 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Confirmada
                </span>
                <span *ngIf="reserva.estado_reserva === 'Pendiente'" class="bg-yellow-300 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Pendiente
                </span>
              </td>
              <td class="px-6 py-4 text-sm text-[#161a2d]">
                <span *ngIf="reserva.entrega === 'Pendiente'" class="bg-yellow-200 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Pendiente
                </span>
                <span *ngIf="reserva.entrega === 'Entregado'" class="bg-green-200 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Entregado
                </span>
              </td>
              <td class="px-6 py-4 text-sm text-[#161a2d]">
                <button 
                  *ngIf="reserva.estado_reserva === 'Confirmada' && reserva.entrega === 'Pendiente'" 
                  (click)="changeDeliveryStatus(reserva.id_reserva)"
                  class="bg-[#4f52ba] text-white py-2 px-6 rounded-md hover:bg-[#3d46a3] text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4f52ba] transition duration-200">
                  Marcar como Entregado
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
  
      <!-- Tabla de Reservas Entregadas -->
      <div class="overflow-x-auto bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-semibold mb-4 text-[#161a2d]">Reservas Entregadas</h2>
        <table class="min-w-full table-auto border-collapse">
          <thead>
            <tr class="bg-[#4f52ba] text-white">
              <th class="text-left px-6 py-4 font-semibold text-sm">ID Reserva</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Nombre Cliente</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Fecha Reserva</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Estado</th>
              <th class="text-left px-6 py-4 font-semibold text-sm">Entrega</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let reserva of deliveredReservations" class="border-b hover:bg-[#f0f4ff] transition duration-200">
              <td class="px-6 py-4 text-sm text-[#161a2d]">{{ reserva.id_reserva }}</td>
              <td class="px-6 py-4 text-sm text-[#161a2d]">{{ reserva.usuario }}</td>
              <td class="px-6 py-4 text-sm text-[#161a2d]">{{ reserva.fecha_inicio | date: 'yyyy-MM-dd' }}</td>
              <td class="px-6 py-4 text-sm">
                <span *ngIf="reserva.estado_reserva === 'Confirmada'" class="bg-blue-300 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Confirmada
                </span>
                <span *ngIf="reserva.estado_reserva === 'Pendiente'" class="bg-yellow-300 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Pendiente
                </span>
              </td>
              <td class="px-6 py-4 text-sm text-[#161a2d]">
                <span *ngIf="reserva.entrega === 'Pendiente'" class="bg-yellow-200 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Pendiente
                </span>
                <span *ngIf="reserva.entrega === 'Entregado'" class="bg-green-200 text-[#161a2d] py-1 px-3 rounded-full text-xs font-semibold">
                  Entregado
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  